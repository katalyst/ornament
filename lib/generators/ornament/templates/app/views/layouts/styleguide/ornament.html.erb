<!DOCTYPE html>
<html lang="en">
  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# website: http://ogp.me/ns/website#">

    <%# Meta tags %>
    <meta charset="utf-8"/>
    <%= render "layouts/seo",
      use_pwa_settings: true,
      theme_colour: "#db892a"
    -%>
    <%= csrf_meta_tags %>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <% unless Rails.env == "production" %>
      <meta name="robots" content="noindex,nofollow"/>
    <% end  %>
    <%= yield :meta %>

    <script>
      Ornament = window.Ornament || {};
      // dataLayer = window.dataLayer = {};
    </script>

    <%# Styles %>
    <%= stylesheet_link_tag "styleguide/styleguide", :media => "all" %>
    <%= yield :styles %>

    <%# Scripts %>
    <%= javascript_include_tag "application" %>
    <%= javascript_include_tag "styleguide/styleguide" %>
    <%= yield :scripts %>

    <%# Google Tag Manager - GTM-XXXXXXX %>
    <%- gtm_code = get_koi_site_setting("site.gtm_code") -%>
    <%- if gtm_code -%>
      <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','<%= gtm_code -%>');</script>
    <%- end -%>

    <%# Webfonts %>
    <%#= render "layouts/webfonts", config: {
      google: {
        families: ['Open Sans:400,700,400italic,700italic'],
      }
    } -%>

    <%# Koi Scripts %>
    <%- koi_scripts = get_koi_site_setting("site.head_scripts") -%>
    <%= koi_scripts if koi_scripts -%>

  </head>

  <body class="styleguide <%= yield :body_class -%>"> 
    <%- if gtm_code -%>
      <%# Google Tag Manager (noscript Version) %>
      <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=<%= gtm_code -%>" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <%- end -%>

    <a class="skip-link" href="#main">skip to content</a>

    <div class="layout">
      <div class="layout--content environment-<%= Rails.env -%>" data-layout-positioner>

        <div class="layout--positioner">
          <div class="styleguide-page">
            <div class="styleguide-page--sidebar-overlay" data-transition="main-sidebar" data-transition-speed="200"></div>
            <div class="styleguide-page--sidebar">
              <button class="styleguide-page--sidebar--close" data-transition="main-sidebar" data-transition-speed="200" title="Close menu">
                <div>
                  <span>Close menu</span>
                  <%= icon "close", width: 16, height: 16 %>
                </div>
              </button>

              <div class="styleguide-page--sidebar--filter">
                <%= icon("search", width: 16, height: 16) %>
                <input type="text" placeholder="Filter" aria-label="Filter pages" data-sidebar-filter-input />
              </div>
              <%= render "layouts/styleguide/styleguide_navigation" %>

            </div>
            <main role="main" class="styleguide-page--main">

              <% large_header = request.path.eql?(styleguide_path) %>
              <header class="header <%= "header__main" if large_header %>" role="banner">
                <div class="<%= large_header ? "header--container" : "styleguide-page--main--container" %> spacing">
                  <div class="spacing-xxx-tight">
                    <h1>
                      <span class="<%= large_header ? "heading-one" : "heading-three" %>"><%= link_to "Ornament", styleguide_path %></span>
                      <span class="type--grey" data-ornament-version></span>
                    </h1>
                    <% if large_header %>
                      <p>The front-end pattern library and styleguide for Katalyst web applications</p>
                    <% end %>
                  </div>
                  <% if large_header %>
                    <div>
                      <div class="button-set button-set__center">
                        <div>
                          <%= link_to "Get Started", "", class:"button button__shadowed" %>
                        </div>
                      </div>
                    </div>
                  <% end %>
                </div>
                <% if large_header %>
                  <div class="header--github">
                    <%= link_to "https://github.com/katalyst/ornament", class: "button button__icon-left icon--white", title: "View on Github" do %>
                      <%= icon("github", width: 24, height: 24) %>
                      <span>View on Github</span>
                    <% end %>
                  </div>
                <% end %>
                <button class="header--menu" title="Open menu" data-transition="main-sidebar" data-transition-speed="200">
                  <%= icon("hamburger", width: 25, height: 23) -%>
                </button>
              </header>

              <%= render "/shared/oldie" -%>
              <%= render "/shared/flash" -%>
              <%= yield :above_layout -%>

              <div class="styleguide-page--main--container styleguide-page--main-content">
                <%- if content_for?(:title) -%>
                  <div class="styleguide--title">
                    <h2 class="heading-one"><%= yield(:title) -%></h2>
                    <%= link_to raw("&lsaquo; Back"), styleguide_path -%>
                  </div>
                <%- end -%>

                <%- if content_for?(:global) || !yield.blank? -%>
                  <a id="main" name="main" tabindex="-1"></a>
                  <div class="layout--main <%= yield(:layout_class) -%>" role="main">
                    <%= content_for?(:global) ? yield(:global) : yield %>
                  </div>
                <%- end -%>
              </div>

              <%= yield :below_layout -%>
            </main>

            <footer class="footer align__right" role="contentinfo">
              By <%= link_to "Katalyst Interactive", "https://katalyst.com.au" %>
            </footer>
          </div>
        </div>
      </div>

    </div>

    <%= yield :scripts_bottom %>
    
    <%= render "layouts/analytics" -%>

    <div data-ornament-icons style="display: none;">
      <div data-ornament-icon="chevron-left"><%= icon("chevron_left") -%></div>
      <div data-ornament-icon="chevron-right"><%= icon("chevron_right") -%></div>
      <div data-ornament-icon="close"><%= icon("close") -%></div>
    </div>
  </body>

</html>
